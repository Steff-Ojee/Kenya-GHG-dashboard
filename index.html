<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Kenya GHG Emissions Dashboard - Carbon Finance Analytics</title>
  <meta
    name="description"
    content="Interactive dashboard analyzing Kenya's greenhouse gas emissions for carbon market opportunities"
  />
  <meta name="author" content="Stephanie Ojee" />
  <meta property="og:title" content="Kenya GHG Dashboard" />
  <meta
    property="og:description"
    content="Tracking emissions for carbon finance planning"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f0f7f4;
      min-height: 100vh;
      padding: 20px;
      color: #003333;
    }
    .container { max-width: 1400px; margin: 0 auto; }

    /* Quick Stats Bar */
    .quick-stats {
      background: #006666;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-around;
      font-size: 0.9rem;
      flex-wrap: wrap;
    }
    .quick-stats span { display: inline-block; margin: 5px; }

    .header {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,51,51,0.1);
      margin-bottom: 30px;
      text-align: center;
      border-top: 4px solid #006666;
    }
    .header h1 { color: #003333; font-size: 2.5rem; margin-bottom: 10px; }
    .header p { color: #004444; font-size: 1.1rem; margin-bottom: 15px; }
    .subtitle { color: #005555; font-size: 0.9rem; }

    .nav-tabs {
      background: white;
      border-radius: 12px;
      padding: 10px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,51,51,0.1);
      display: flex;
      gap: 5px;
      overflow-x: auto;
    }
    .nav-tab {
      padding: 12px 20px;
      border: none;
      background: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      color: #005555;
      white-space: nowrap;
    }
    .nav-tab.active {
      background: #006666;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,102,102,0.2);
    }
    .nav-tab:hover:not(.active) { background: #e6f3f0; color: #003333; }

    .tab-content { display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: 0 2px 10px rgba(0,51,51,0.1);
      border-left: 4px solid #006666;
    }
    .card-teal { background: #006666; color: white; }
    .card-alert { background: #fff5f5; border-left-color: #d55e00; }
    .card-warning { background: #fffaf0; border-left-color: #e69f00; }
    .card-success { background: #f0fdf4; border-left-color: #009e73; }

    .grid { display: grid; gap: 25px; }
    .grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
    .grid-3 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    .grid-4 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }

    .metric-card {
      text-align: center;
      padding: 20px;
      background: #f9fffe;
      border-radius: 8px;
      border: 1px solid #e6f3f0;
    }
    .metric-value { font-size: 2rem; font-weight: bold; color: #003333; margin-bottom: 5px; }
    .metric-label { color: #005555; font-size: 0.9rem; }

    .chart-container { position: relative; height: 400px; margin: 20px 0; }
    .chart-container-small { position: relative; height: 250px; margin: 20px 0; }

    .progress-bar {
      background: #e6f3f0;
      border-radius: 8px;
      height: 8px;
      overflow: hidden;
      margin: 10px 0;
    }
    .progress-fill { height: 100%; border-radius: 8px; transition: width 0.5s ease; }
    .progress-high { background: #d55e00; }
    .progress-medium { background: #e69f00; }
    .progress-low { background: #009e73; }

    .status-badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    .status-active { background: #d1fae5; color: #065f46; }
    .status-partial { background: #fef3c7; color: #92400e; }
    .status-limited { background: #fee2e2; color: #991b1b; }

    .timeline { position: relative; padding-left: 30px; }
    .timeline::before {
      content: '';
      position: absolute;
      left: 15px; top: 0; bottom: 0;
      width: 2px; background: #006666;
    }
    .timeline-item {
      position: relative; margin-bottom: 30px; padding: 20px;
      background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,51,51,0.1);
    }
    .timeline-item::before {
      content: '';
      position: absolute; left: -37px; top: 25px;
      width: 12px; height: 12px; border-radius: 50%;
      background: #006666; border: 3px solid white;
      box-shadow: 0 0 0 3px rgba(0,102,102,0.2);
    }
    .timeline-year { font-size: 1.2rem; font-weight: bold; color: #003333; margin-bottom: 5px; }
    .timeline-event { color: #005555; margin-bottom: 10px; }

    .scenario-controls { background: #f9fffe; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #e6f3f0; }
    .control-group { margin-bottom: 15px; }
    .control-group label { display: block; margin-bottom: 5px; font-weight: 500; color: #003333; }
    .control-group input[type="range"] { width: 100%; margin-bottom: 5px; accent-color: #006666; }
    .control-group .value-display { font-size: 0.9rem; color: #005555; }

    .county-selector {
      background: white; border: 1px solid #e6f3f0; border-radius: 8px; padding: 10px; margin-bottom: 20px;
    }
    .county-selector select {
      width: 100%; padding: 8px; border: 1px solid #e6f3f0; background: white; font-size: 1rem; color: #003333; border-radius: 4px;
    }

    .data-source-badge {
      background: #f0f7f4; padding: 8px 16px; border-radius: 20px; font-size: 0.85rem; color: #004444; display: inline-block; margin-top: 10px;
    }
    .data-source-badge a { color: #006666; text-decoration: none; font-weight: 500; }
    .data-source-badge a:hover { text-decoration: underline; }

    .methodology-note {
      background: #f9fffe; border: 1px solid #e6f3f0; border-radius: 8px; padding: 15px; margin-top: 20px; font-size: 0.9rem; color: #004444;
    }

    .export-btn {
      background: #006666; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 0.9rem; margin: 10px; transition: all 0.3s;
    }
    .export-btn:hover {
      background: #007777; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,102,102,0.2);
    }

    .footer {
      text-align: center; padding: 30px 20px; color: #005555; margin-top: 40px; background: white; border-radius: 12px; border-top: 4px solid #006666;
    }
    .footer .author { font-weight: 600; color: #003333; margin-bottom: 10px; }

    @media (max-width: 768px) {
      .header h1 { font-size: 2rem; }
      .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
      .nav-tabs { flex-wrap: wrap; }
      .quick-stats { font-size: 0.8rem; }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Quick Stats Bar (emoji-free) -->
    <div class="quick-stats" aria-label="Quick statistics">
      <span>Data Coverage: 47/47 counties</span>
      <span>Last Update: September 2024</span>
      <span>IPCC 2006 Guidelines</span>
      <span>Confidence Level: Medium</span>
    </div>

    <header class="header">
      <h1>Kenya GHG Emissions Dashboard</h1>
      <p>Comprehensive greenhouse gas accounting analysis with carbon finance applications</p>
      <div class="subtitle">
        Enhanced dashboard with MRV assessment, regional comparisons &amp; carbon market intelligence | Based on 2024 BTR data
      </div>
    </header>

    <nav class="nav-tabs" role="tablist" aria-label="Dashboard sections">
      <button class="nav-tab active" data-tab="overview" aria-selected="true">Overview</button>
      <button class="nav-tab" data-tab="emissions" aria-selected="false">Emissions Data</button>
      <button class="nav-tab" data-tab="scenarios" aria-selected="false">Scenarios</button>
      <button class="nav-tab" data-tab="counties" aria-selected="false">Counties</button>
      <button class="nav-tab" data-tab="regional" aria-selected="false">Regional</button>
      <button class="nav-tab" data-tab="carbon" aria-selected="false">Carbon Credits</button>
      <button class="nav-tab" data-tab="mrv" aria-selected="false">MRV System</button>
      <button class="nav-tab" data-tab="challenges" aria-selected="false">Challenges</button>
      <button class="nav-tab" data-tab="timeline" aria-selected="false">Timeline</button>
    </nav>

    <main>
      <!-- Overview Tab -->
      <section id="overview" class="tab-content active">
        <div class="card card-teal">
          <h2 style="margin-bottom: 20px; font-size: 1.8rem;">Kenya's GHG Accounting Framework</h2>
          <p style="margin-bottom: 25px; opacity: 0.95;">
            Established under the Climate Change Act 2016, Kenya's GHG accounting system follows IPCC 2006 guidelines with plans to transition to IPCC 2019 refinement. The framework coordinates across five main sectors through inter-ministerial working groups.
          </p>
          <div class="grid grid-4">
            <div class="metric-card">
              <div class="metric-value">113.3</div>
              <div class="metric-label">Mt CO₂eq Total (2022)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">47</div>
              <div class="metric-label">Counties Covered</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">23</div>
              <div class="metric-label">ASAL Counties</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">200+</div>
              <div class="metric-label">Active Carbon Projects</div>
            </div>
          </div>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">National Emissions by Sector (2022)</h3>
            <div class="chart-container">
              <canvas id="sectorChart" role="img" aria-label="Bar chart of national emissions by sector"></canvas>
            </div>
            <div class="data-source-badge">
              Source: <a href="https://unfccc.int/documents/645091" target="_blank" rel="noopener">Kenya BTR 2024</a>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">Emissions Trend (2010–2022)</h3>
            <div class="chart-container">
              <canvas id="trendChart" role="img" aria-label="Line chart of total emissions trend"></canvas>
            </div>
            <button class="export-btn" onclick="exportChart('trendChart')">Export Chart</button>
          </div>
        </div>
      </section>

      <!-- Emissions Data Tab -->
      <section id="emissions" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 20px; color: #003333;">Detailed Emissions Analysis</h2>
          <div class="grid grid-2">
            <div class="card">
              <h3 style="margin-bottom: 15px; color: #003333;">Sectoral Breakdown (Mt CO₂eq)</h3>
              <div class="chart-container">
                <canvas id="detailedSectorChart" role="img" aria-label="Doughnut chart of sectoral breakdown in megatonnes"></canvas>
              </div>
            </div>
            <div class="card">
              <h3 style="margin-bottom: 15px; color: #003333;">GHG Gas Composition</h3>
              <div class="chart-container">
                <canvas id="gasChart" role="img" aria-label="Pie chart of gas composition: CO2, CH4, N2O"></canvas>
              </div>
            </div>
          </div>
        </div>

        <div class="grid grid-3">
          <div class="card card-success">
            <h4 style="color: #065f46; margin-bottom: 15px;">Carbon Sinks</h4>
            <div class="metric-value" style="color: #065f46;">-18.3</div>
            <div class="metric-label" style="color: #065f46;">Mt CO₂eq from Forestry</div>
            <p style="color: #065f46; font-size: 0.9rem; margin-top: 10px;">Forest carbon sequestration partially offsets national emissions</p>
          </div>
          <div class="card card-alert">
            <h4 style="color: #991b1b; margin-bottom: 15px;">Livestock Emissions</h4>
            <div class="metric-value" style="color: #991b1b;">34.2</div>
            <div class="metric-label" style="color: #991b1b;">Mt CO₂eq from Livestock</div>
            <p style="color: #991b1b; font-size: 0.9rem; margin-top: 10px;">Largest single emission source, mainly from cattle</p>
          </div>
          <div class="card card-warning">
            <h4 style="color: #92400e; margin-bottom: 15px;">Energy Growth</h4>
            <div class="metric-value" style="color: #92400e;">+4.2%</div>
            <div class="metric-label" style="color: #92400e;">Annual Growth Rate</div>
            <p style="color: #92400e; font-size: 0.9rem; margin-top: 10px;">Fastest growing emissions sector</p>
          </div>
        </div>
      </section>

      <!-- Scenarios Tab -->
      <section id="scenarios" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 20px; color: #003333;">Scenario Analysis Tool</h2>
          <p style="color: #005555; margin-bottom: 20px;">Adjust parameters to model different emissions scenarios based on policy interventions and development pathways.</p>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">Scenario Parameters</h3>
            <div class="scenario-controls">
              <div class="control-group">
                <label for="economicGrowth">Economic Growth Rate (%)</label>
                <input type="range" id="economicGrowth" min="2" max="8" value="5" step="0.5" oninput="updateScenario()">
                <div class="value-display">Current: <span id="economicGrowthValue">5.0</span>%</div>
              </div>
              <div class="control-group">
                <label for="renewableShare">Renewable Energy Share (%)</label>
                <input type="range" id="renewableShare" min="10" max="90" value="30" step="5" oninput="updateScenario()">
                <div class="value-display">Current: <span id="renewableShareValue">30</span>%</div>
              </div>
              <div class="control-group">
                <label for="forestCover">Forest Cover Change (%)</label>
                <input type="range" id="forestCover" min="-20" max="50" value="10" step="5" oninput="updateScenario()">
                <div class="value-display">Current: <span id="forestCoverValue">+10</span>%</div>
              </div>
              <div class="control-group">
                <label for="livestockEfficiency">Livestock Efficiency Improvement (%)</label>
                <input type="range" id="livestockEfficiency" min="0" max="40" value="15" step="5" oninput="updateScenario()">
                <div class="value-display">Current: <span id="livestockEfficiencyValue">15</span>%</div>
              </div>
            </div>
          </div>

          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">Projected Emissions (2030)</h3>
            <div class="chart-container">
              <canvas id="scenarioChart" role="img" aria-label="Bar chart comparing current vs projected emissions by sector"></canvas>
            </div>
          </div>
        </div>

        <div class="card card-teal">
          <h3 style="margin-bottom: 20px;">Scenario Results Summary</h3>
          <div class="grid grid-3">
            <div class="metric-card">
              <div class="metric-value" id="projectedTotal">105.2</div>
              <div class="metric-label">Total Mt CO₂eq (2030)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value" id="emissionReduction">-12.4</div>
              <div class="metric-label">vs BAU Scenario</div>
            </div>
            <div class="metric-card">
              <div class="metric-value" id="ndcAlignment">78%</div>
              <div class="metric-label">NDC Target Alignment</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Counties Tab -->
      <section id="counties" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 20px; color: #003333;">County-Level Analysis</h2>
          <div class="county-selector">
            <label for="countySelect" class="sr-only">Select county</label>
            <select id="countySelect" onchange="updateCountyData()">
              <option value="all">All Counties Overview</option>
              <option value="turkana">Turkana (ASAL)</option>
              <option value="marsabit">Marsabit (ASAL)</option>
              <option value="garissa">Garissa (ASAL)</option>
              <option value="mandera">Mandera (ASAL)</option>
              <option value="wajir">Wajir (ASAL)</option>
              <option value="kajiado">Kajiado (ASAL)</option>
              <option value="nairobi">Nairobi</option>
              <option value="kiambu">Kiambu</option>
              <option value="nakuru">Nakuru</option>
              <option value="mombasa">Mombasa</option>
            </select>
          </div>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">ASAL Counties Emissions Profile</h3>
            <div class="chart-container">
              <canvas id="asalChart" role="img" aria-label="Bar chart of ASAL county emissions"></canvas>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">County Emissions per Capita</h3>
            <div class="chart-container">
              <canvas id="perCapitaChart" role="img" aria-label="Scatter plot of county population vs per capita emissions"></canvas>
            </div>
          </div>
        </div>

        <div class="card card-warning">
          <h3 style="margin-bottom: 20px; color: #92400e;">ASAL-Specific Challenges</h3>
          <div class="grid grid-2">
            <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
              <h4 style="font-weight: 600; margin-bottom: 8px; color: #003333;">Pastoral Mobility</h4>
              <p style="font-size: 0.9rem; color: #004444;">23 ASAL counties with complex livestock movement patterns affecting emission calculations</p>
            </div>
            <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
              <h4 style="font-weight: 600; margin-bottom: 8px; color: #003333;">Land Use Dynamics</h4>
              <p style="font-size: 0.9rem; color: #004444;">Rapid land use changes in peri-urban ASAL areas not captured in static models</p>
            </div>
            <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
              <h4 style="font-weight: 600; margin-bottom: 8px; color: #003333;">Climate Variability</h4>
              <p style="font-size: 0.9rem; color: #004444;">High rainfall variability affects carbon sequestration estimates</p>
            </div>
            <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px;">
              <h4 style="font-weight: 600; margin-bottom: 8px; color: #003333;">Data Gaps</h4>
              <p style="font-size: 0.9rem; color: #004444;">Limited county-level activity data and monitoring infrastructure</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Regional Tab -->
      <section id="regional" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 20px; color: #003333;">East African &amp; Southeast Asian Comparison</h2>
          <div class="chart-container">
            <canvas id="regionalChart" role="img" aria-label="Bar chart of regional total emissions comparison"></canvas>
          </div>
        </div>

        <div class="grid grid-4">
          <div class="card">
            <h3 style="margin-bottom: 15px; color: #003333;">Kenya</h3>
            <div class="metric-value">87.6</div>
            <div class="metric-label">Mt CO₂eq (2020)</div>
            <div style="margin-top: 15px;">
              <div style="font-size: 0.9rem; color: #005555;">Per capita: 1.8 t CO₂eq</div>
              <div style="font-size: 0.9rem; color: #005555;">Main source: Livestock</div>
              <div style="font-size: 0.9rem; color: #005555;">Carbon projects: 200+</div>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 15px; color: #003333;">Vietnam</h3>
            <div class="metric-value" style="color: #007777;">316.0</div>
            <div class="metric-label">Mt CO₂eq (2020)</div>
            <div style="margin-top: 15px;">
              <div style="font-size: 0.9rem; color: #005555;">Per capita: 3.2 t CO₂eq</div>
              <div style="font-size: 0.9rem; color: #005555;">Main source: Energy</div>
              <div style="font-size: 0.9rem; color: #007777; font-weight: 600;">Carbon Market: Emerging</div>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 15px; color: #003333;">Ethiopia</h3>
            <div class="metric-value">180.2</div>
            <div class="metric-label">Mt CO₂eq (2020)</div>
            <div style="margin-top: 15px;">
              <div style="font-size: 0.9rem; color: #005555;">Per capita: 1.6 t CO₂eq</div>
              <div style="font-size: 0.9rem; color: #005555;">Main source: Agriculture</div>
              <div style="font-size: 0.9rem; color: #005555;">Carbon projects: 50+</div>
            </div>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 15px; color: #003333;">Tanzania</h3>
            <div class="metric-value">98.4</div>
            <div class="metric-label">Mt CO₂eq (2020)</div>
            <div style="margin-top: 15px;">
              <div style="font-size: 0.9rem; color: #005555;">Per capita: 1.7 t CO₂eq</div>
              <div style="font-size: 0.9rem; color: #005555;">Main source: LULUCF</div>
              <div style="font-size: 0.9rem; color: #005555;">Carbon projects: 30+</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 20px; color: #003333;">Regional Insights &amp; Carbon Market Potential</h3>
          <div class="grid grid-2">
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <h4 style="font-weight: 600; color: #003333; margin-bottom: 10px;">Kenya vs Vietnam Opportunity</h4>
              <p style="color: #005555; font-size: 0.9rem;">Kenya's experience with 200+ carbon projects provides valuable lessons for Vietnam's emerging market. Key transferable expertise: community engagement models, MRV systems, and nature-based solutions.</p>
            </div>
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <h4 style="font-weight: 600; color: #003333; margin-bottom: 10px;">Forest Carbon Potential</h4>
              <p style="color: #005555; font-size: 0.9rem;">Vietnam's extensive forest resources (14.7M ha) present significant REDD+ opportunities similar to Kenya's rangeland carbon projects.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Carbon Credits Tab -->
      <section id="carbon" class="tab-content" aria-hidden="true">
        <div class="card card-teal">
          <h2 style="margin-bottom: 20px;">Carbon Credit Projects in Kenya</h2>
          <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
            <h4 style="margin-bottom: 10px;">New Regulatory Framework (2024)</h4>
            <p style="opacity: 0.95; margin-bottom: 10px;">Climate Change (Carbon Markets) Regulations 2024 effective May 17, 2024</p>
            <p style="opacity: 0.95;">National Carbon Registry operational • Enhanced benefit-sharing requirements • Aligned with Article 6</p>
          </div>
          <div class="grid grid-4">
            <div class="metric-card">
              <div class="metric-value">200+</div>
              <div class="metric-label">Active Projects</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">11M+</div>
              <div class="metric-label">Credits Issued (2022)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">70%</div>
              <div class="metric-label">In ASAL Counties</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">$35</div>
              <div class="metric-label">Premium Price/tonne</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 20px; color: #003333;">Project Types Distribution</h3>
          <div class="chart-container">
            <canvas id="carbonProjectsChart" role="img" aria-label="Doughnut chart of carbon project types distribution"></canvas>
          </div>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 20px; color: #003333;">2024 Benefit-Sharing Requirements</h3>
          <div class="grid grid-2">
            <div style="border: 2px solid #006666; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <h4 style="font-weight: 600; color: #003333; margin-bottom: 10px;">Land-based Projects</h4>
              <div style="text-align: center; margin: 15px 0;">
                <span style="font-size: 2rem; font-weight: bold; color: #003333;">40%</span>
                <p style="color: #005555; font-size: 0.9rem; margin: 5px 0;">of annual earnings to communities</p>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Includes forestry, agriculture, REDD+, and land use projects</p>
            </div>

            <div style="border: 2px solid #006666; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <h4 style="font-weight: 600; color: #003333; margin-bottom: 10px;">Non-land Projects</h4>
              <div style="text-align: center; margin: 15px 0;">
                <span style="font-size: 2rem; font-weight: bold; color: #003333;">25%</span>
                <p style="color: #005555; font-size: 0.9rem; margin: 5px 0;">of annual earnings to communities</p>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Includes cookstoves, solar, clean energy, and technology projects</p>
            </div>
          </div>
        </div>
      </section>

      <!-- MRV System Tab -->
      <section id="mrv" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 20px; color: #003333;">MRV System Maturity Assessment</h2>
          <p style="color: #005555; margin-bottom: 20px;">Monitoring, Reporting, and Verification system capabilities critical for carbon market participation</p>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 20px; color: #003333;">System Components Assessment</h3>
          <div style="space-y: 15px;">
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Data Collection Infrastructure</h4>
                <span class="status-badge status-partial">Developing</span>
              </div>
              <div class="progress-bar" aria-label="Data Collection Infrastructure 60%">
                <div class="progress-fill progress-medium" style="width: 60%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">National GHG inventory system operational, county-level systems in development</p>
            </div>

            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Reporting Frequency</h4>
                <span class="status-badge status-active">Compliant</span>
              </div>
              <div class="progress-bar" aria-label="Reporting Frequency 85%">
                <div class="progress-fill progress-low" style="width: 85%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Biennial reports submitted, annual inventories for key sectors</p>
            </div>

            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Third-Party Verification</h4>
                <span class="status-badge status-active">Established</span>
              </div>
              <div class="progress-bar" aria-label="Third-Party Verification 90%">
                <div class="progress-fill progress-low" style="width: 90%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Accredited verifiers for carbon projects, UNFCCC review for national reports</p>
            </div>

            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Digital Systems Integration</h4>
                <span class="status-badge status-limited">Basic</span>
              </div>
              <div class="progress-bar" aria-label="Digital Systems Integration 40%">
                <div class="progress-fill progress-high" style="width: 40%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">KCERT tool in development, limited real-time monitoring capabilities</p>
            </div>
          </div>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">MRV Gaps for Carbon Finance</h3>
            <ul style="color: #005555; line-height: 1.8;">
              <li>Limited baseline data for new project types</li>
              <li>Insufficient remote sensing coverage in ASALs</li>
              <li>Weak integration between national and project-level MRV</li>
              <li>Limited capacity for soil carbon measurements</li>
              <li>Inconsistent methodologies across sectors</li>
            </ul>
          </div>
          <div class="card">
            <h3 style="margin-bottom: 20px; color: #003333;">International Standards Alignment</h3>
            <div style="margin-bottom: 15px;">
              <h4 style="color: #004444; font-size: 1rem; margin-bottom: 8px;">IPCC 2006 Guidelines</h4>
              <p style="font-size: 0.9rem; color: #005555;">Fully implemented with plans for 2019 refinement</p>
            </div>
            <div style="margin-bottom: 15px;">
              <h4 style="color: #004444; font-size: 1rem; margin-bottom: 8px;">ISO 14064 Series</h4>
              <p style="font-size: 0.9rem; color: #005555;">Partial adoption for project-level accounting</p>
            </div>
            <div style="margin-bottom: 15px;">
              <h4 style="color: #004444; font-size: 1rem; margin-bottom: 8px;">GHG Protocol</h4>
              <p style="font-size: 0.9rem; color: #005555;">Corporate reporting framework adopted</p>
            </div>
            <div>
              <h4 style="color: #004444; font-size: 1rem; margin-bottom: 8px;">TCFD Framework</h4>
              <p style="font-size: 0.9rem; color: #005555;">Limited implementation in financial sector</p>
            </div>
          </div>
        </div>

        <div class="methodology-note">
          <strong>Methodology Note:</strong> This MRV assessment is based on Kenya's First Biennial Transparency Report (2024) and follows IPCC 2006 guidelines with Tier 1 and Tier 2 methodologies. Data confidence levels vary by sector, with energy and industrial processes having higher certainty than agriculture and LULUCF sectors. County-level data remains limited, affecting sub-national carbon project verification accuracy.
        </div>
      </section>

      <!-- Challenges Tab -->
      <section id="challenges" class="tab-content" aria-hidden="true">
        <div class="card card-alert">
          <h2 style="margin-bottom: 15px; color: #991b1b;">Critical Data Gaps &amp; Challenges</h2>
          <p style="color: #991b1b; margin-bottom: 20px;">
            Kenya's GHG accounting faces significant challenges that impact the accuracy of carbon credit assessments, particularly in arid and semi-arid lands where traditional methodologies may not capture local realities.
          </p>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 20px; color: #003333;">Data Gap Analysis</h3>
          <div style="space-y: 15px;">
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">County-level Data</h4>
                <span class="status-badge status-limited">Very High Impact</span>
              </div>
              <div class="progress-bar" aria-label="County-level Data impact 90%">
                <div class="progress-fill progress-high" style="width: 90%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Limited sub-national emissions data availability across 47 counties</p>
            </div>
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Land Use Changes</h4>
                <span class="status-badge status-limited">Very High Impact</span>
              </div>
              <div class="progress-bar" aria-label="Land Use Changes impact 85%">
                <div class="progress-fill progress-high" style="width: 85%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Uncertain land use transition data, especially in ASALs</p>
            </div>
            <div style="border: 1px solid #e6f3f0; border-radius: 8px; padding: 20px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h4 style="font-weight: 600; color: #003333;">Activity Data vs Emissions</h4>
                <span class="status-badge status-partial">High Impact</span>
              </div>
              <div class="progress-bar" aria-label="Activity Data vs Emissions impact 75%">
                <div class="progress-fill progress-medium" style="width: 75%;"></div>
              </div>
              <p style="color: #005555; font-size: 0.9rem;">Mismatch between reported activities and actual emissions</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Timeline Tab -->
      <section id="timeline" class="tab-content" aria-hidden="true">
        <div class="card">
          <h2 style="margin-bottom: 30px; color: #003333;">GHG Accounting Development Timeline</h2>
          <div class="timeline">
            <div class="timeline-item">
              <div class="timeline-year">2016</div>
              <div class="timeline-event">Climate Change Act enacted — Legal framework established</div>
              <span class="status-badge" style="background: #d1fae5; color: #065f46;">Legal</span>
            </div>
            <div class="timeline-item">
              <div class="timeline-year">2018</div>
              <div class="timeline-event">First National Communication submitted to UNFCCC</div>
              <span class="status-badge" style="background: #dbeafe; color: #1e3a8a;">Report</span>
            </div>
            <div class="timeline-item">
              <div class="timeline-year">2020</div>
              <div class="timeline-event">Updated Nationally Determined Contribution (NDC) submitted</div>
              <span class="status-badge" style="background: #fef3c7; color: #92400e;">Policy</span>
            </div>
            <div class="timeline-item">
              <div class="timeline-year">2023</div>
              <div class="timeline-event">Africa Climate Summit hosted in Nairobi — Climate leadership demonstration</div>
              <span class="status-badge" style="background: #d1fae5; color: #065f46;">Leadership</span>
            </div>
            <div class="timeline-item">
              <div class="timeline-year">2024</div>
              <div class="timeline-event">First Biennial Transparency Report submitted with comprehensive 2022 data</div>
              <span class="status-badge" style="background: #dbeafe; color: #1e3a8a;">Report</span>
            </div>
            <div class="timeline-item">
              <div class="timeline-year">2024</div>
              <div class="timeline-event">Carbon Market Regulations enacted — comprehensive framework operational</div>
              <span class="status-badge" style="background: #fef3c7; color: #92400e;">Regulatory</span>
            </div>
          </div>
        </div>

        <div class="card" style="background: #f0f7f4;">
          <h3 style="margin-bottom: 20px; color: #003333;">Future Milestones</h3>
          <div style="space-y: 10px;">
            <div style="display: flex; align-items: center; margin-bottom: 10px;">
              <span style="color: #004444;">Enhanced Transparency Framework full implementation (2024–2025)</span>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 10px;">
              <span style="color: #004444;">County-level GHG inventory development and deployment</span>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 10px;">
              <span style="color: #004444;">KCERT tool expansion and public deployment</span>
            </div>
            <div style="display: flex; align-items: center;">
              <span style="color: #004444;">Regional GHG database integration with EAC partners</span>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p class="author">Developed by Stephanie Ojee | 2024 | ESG &amp; Climate Finance Professional</p>
      <p>For carbon market transparency and climate action</p>
      <p style="margin-top: 10px; font-size: 0.9rem;">Natural Resources Management &amp; Climate Policy Analysis</p>
      <p style="margin-top: 5px; font-size: 0.8rem;">
        Data sources: Kenya's First BTR (2024), UNFCCC, World Bank, Kenya National Bureau of Statistics, Climate Change Directorate
      </p>
      <p style="margin-top: 5px; font-size: 0.7rem;">
        Latest official data:
        <a href="https://unfccc.int/documents/636608" style="color: #006666;" target="_blank" rel="noopener">Kenya BTR 2024</a> |
        <a href="https://climatechange.go.ke/" style="color: #006666;" target="_blank" rel="noopener">Climate Change Directorate</a>
      </p>
    </footer>
  </div>

  <script>
    // ---------- Color-blind–safe palette (Okabe–Ito) ----------
    const PALETTE = {
      blue:      '#0072B2',
      orange:    '#E69F00',
      green:     '#009E73',
      vermilion: '#D55E00',
      purple:    '#CC79A7',
      yellow:    '#F0E442',
      sky:       '#56B4E9',
      black:     '#000000'
    };
    const SERIES = [
      PALETTE.blue, PALETTE.orange, PALETTE.green, PALETTE.vermilion,
      PALETTE.purple, PALETTE.yellow, PALETTE.sky, PALETTE.black
    ];

    // ---------- Global data ----------
    const emissionsData = {
      2010: { energy: 15.2, agriculture: 29.8, forestry: -15.2, waste: 3.1, industrial: 2.3, total: 73.2 },
      2012: { energy: 16.1, agriculture: 31.2, forestry: -16.1, waste: 3.3, industrial: 2.5, total: 76.8 },
      2014: { energy: 17.3, agriculture: 32.1, forestry: -16.8, waste: 3.5, industrial: 2.8, total: 79.1 },
      2016: { energy: 18.5, agriculture: 33.4, forestry: -17.2, waste: 3.8, industrial: 3.1, total: 82.3 },
      2018: { energy: 19.8, agriculture: 34.6, forestry: -17.9, waste: 4.1, industrial: 3.4, total: 84.9 },
      2020: { energy: 21.5, agriculture: 36.1, forestry: -18.3, waste: 4.4, industrial: 3.7, total: 87.6 },
      2022: { energy: 23.2, agriculture: 37.8, forestry: -18.8, waste: 4.8, industrial: 4.1, total: 113.3 }
    };

    const regionalData = {
      kenya:   { emissions: 87.6,  perCapita: 1.8, mainSource: 'Livestock',   carbonProjects: 200 },
      vietnam: { emissions: 316.0, perCapita: 3.2, mainSource: 'Energy',      carbonProjects: 15  },
      ethiopia:{ emissions: 180.2, perCapita: 1.6, mainSource: 'Agriculture', carbonProjects: 50  },
      tanzania:{ emissions: 98.4,  perCapita: 1.7, mainSource: 'LULUCF',      carbonProjects: 30  },
      uganda:  { emissions: 89.1,  perCapita: 1.9, mainSource: 'Agriculture', carbonProjects: 25  },
      rwanda:  { emissions: 12.3,  perCapita: 0.9, mainSource: 'Agriculture', carbonProjects: 10  }
    };

    // ---------- Scenario globals ----------
    let scenarioChart;
    const baselineEmissions = {
      energy: 21.5,
      agriculture_crops: 8.7,
      agriculture_livestock: 27.4,
      forestry: -46.8,
      waste: 5.2,
      industrial: 3.7
    };

    // ---------- Tabs ----------
    const enableTabs = () => {
      const tabs = document.querySelectorAll('.nav-tab');
      const sections = document.querySelectorAll('.tab-content');
      tabs.forEach(btn => {
        btn.addEventListener('click', () => {
          const target = btn.getAttribute('data-tab');
          tabs.forEach(t => t.classList.remove('active'));
          tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
          btn.classList.add('active');
          btn.setAttribute('aria-selected', 'true');
          sections.forEach(sec => {
            if (sec.id === target) {
              sec.classList.add('active');
              sec.setAttribute('aria-hidden', 'false');
            } else {
              sec.classList.remove('active');
              sec.setAttribute('aria-hidden', 'true');
            }
          });

          // Lazy-init charts for relevant tabs
          setTimeout(() => {
            if (target === 'emissions') initializeEmissionsCharts();
            if (target === 'scenarios') initializeScenarioChart();
            if (target === 'counties') initializeCountyCharts();
            if (target === 'regional') initializeRegionalChart();
            if (target === 'carbon') initializeCarbonCharts();
            // MRV charts are represented by progress bars for now
          }, 100);
        });
      });
    };

    // ---------- Exports ----------
    function exportChart(chartId) {
      const canvas = document.getElementById(chartId);
      const url = canvas.toDataURL('image/png');
      const link = document.createElement('a');
      link.download = `${chartId}_${new Date().toISOString().split('T')[0]}.png`;
      link.href = url;
      link.click();
    }

    // ---------- Scenario modeling ----------
    function updateScenario() {
      const economicGrowth = Number(document.getElementById('economicGrowth').value);
      const renewableShare = Number(document.getElementById('renewableShare').value);
      const forestCover = Number(document.getElementById('forestCover').value);
      const livestockEfficiency = Number(document.getElementById('livestockEfficiency').value);

      document.getElementById('economicGrowthValue').textContent = economicGrowth.toFixed(1);
      document.getElementById('renewableShareValue').textContent = renewableShare;
      document.getElementById('forestCoverValue').textContent = forestCover > 0 ? `+${forestCover}` : `${forestCover}`;
      document.getElementById('livestockEfficiencyValue').textContent = livestockEfficiency;

      // Simple elasticities for demo
      const energyImpact = baselineEmissions.energy * (1 + (economicGrowth/100)*0.8 - (renewableShare/100)*0.6);
      const forestryImpact = baselineEmissions.forestry * (1 + forestCover/100);
      const livestockImpact = baselineEmissions.agriculture_livestock * (1 - (livestockEfficiency/100)*0.3);

      const totalProjected = energyImpact + baselineEmissions.agriculture_crops + livestockImpact +
                             forestryImpact + baselineEmissions.waste + baselineEmissions.industrial;

      const reduction = 117.6 - totalProjected;
      const ndcAlignment = Math.min(100, Math.max(0, (reduction / 30) * 100));

      document.getElementById('projectedTotal').textContent = totalProjected.toFixed(1);
      document.getElementById('emissionReduction').textContent =
        (reduction >= 0 ? '-' : '+') + Math.abs(reduction).toFixed(1);
      document.getElementById('ndcAlignment').textContent = Math.round(ndcAlignment) + '%';

      updateScenarioChart(energyImpact, livestockImpact, forestryImpact);
    }

    function updateScenarioChart(energy, livestock, forestry) {
      if (scenarioChart) {
        scenarioChart.data.datasets[1].data = [
          energy, baselineEmissions.agriculture_crops, livestock,
          forestry, baselineEmissions.waste, baselineEmissions.industrial
        ];
        scenarioChart.update();
      }
    }

    function updateCountyData() {
      const county = document.getElementById('countySelect').value;
      console.log('Updating data for county:', county);
      // Placeholder for county-specific data hooks
    }

    // ---------- Chart initializers ----------
    function initializeOverviewCharts() {
      // Sector bar
      const ctx1 = document.getElementById('sectorChart').getContext('2d');
      new Chart(ctx1, {
        type: 'bar',
        data: {
          labels: ['Energy', 'Crops', 'Livestock', 'Forestry', 'Waste', 'Industrial'],
          datasets: [{
            label: 'Mt CO₂eq',
            data: [23.2, 8.7, 27.4, -18.8, 4.8, 4.1],
            backgroundColor: [PALETTE.blue, PALETTE.orange, PALETTE.green, PALETTE.purple, PALETTE.yellow, PALETTE.sky],
            borderColor: '#ffffff',
            borderWidth: 1,
            borderRadius: 6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y} Mt CO₂eq`
              }
            }
          },
          scales: {
            y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.08)' } },
            x: { grid: { display: false } }
          }
        }
      });

      // Trend line
      const ctx2 = document.getElementById('trendChart').getContext('2d');
      new Chart(ctx2, {
        type: 'line',
        data: {
          labels: Object.keys(emissionsData),
          datasets: [{
            label: 'Total Emissions (Mt CO₂eq)',
            data: Object.values(emissionsData).map(d => d.total),
            borderColor: PALETTE.blue,
            backgroundColor: 'rgba(0,114,178,0.12)',
            pointBackgroundColor: PALETTE.blue,
            pointRadius: 3,
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            y: { beginAtZero: false, grid: { color: 'rgba(0,0,0,0.08)' } },
            x: { grid: { display: false } }
          }
        }
      });
    }

    function initializeEmissionsCharts() {
      // Doughnut of sectors (absolute values)
      const ctx3 = document.getElementById('detailedSectorChart');
      if (ctx3) {
        new Chart(ctx3.getContext('2d'), {
          type: 'doughnut',
          data: {
            labels: ['Livestock', 'Energy', 'Crops', 'Forestry (sink)', 'Waste', 'Industrial'],
            datasets: [{
              data: [34.2, 23.2, 8.7, 18.8, 4.8, 4.1], // Using magnitudes for sink display
              backgroundColor: [PALETTE.green, PALETTE.blue, PALETTE.orange, PALETTE.purple, PALETTE.yellow, PALETTE.sky],
              borderColor: '#ffffff',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: { padding: 20, usePointStyle: true }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.parsed || 0;
                    return `${label}: ${value} Mt CO₂eq`;
                  }
                }
              }
            }
          }
        });
      }

      // Gas composition
      const ctx4 = document.getElementById('gasChart');
      if (ctx4) {
        new Chart(ctx4.getContext('2d'), {
          type: 'pie',
          data: {
            labels: ['CO₂', 'CH₄', 'N₂O'],
            datasets: [{
              data: [44, 51, 5],
              backgroundColor: [PALETTE.blue, PALETTE.orange, PALETTE.green],
              borderColor: '#ffffff',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'bottom' }
            }
          }
        });
      }
    }

    function initializeScenarioChart() {
      const ctx = document.getElementById('scenarioChart');
      if (ctx) {
        scenarioChart = new Chart(ctx.getContext('2d'), {
          type: 'bar',
          data: {
            labels: ['Energy', 'Crops', 'Livestock', 'Forestry', 'Waste', 'Industrial'],
            datasets: [{
              label: 'Current (2022)',
              data: [23.2, 8.7, 34.2, -18.8, 4.8, 4.1],
              backgroundColor: 'rgba(0,114,178,0.65)', // blue
              borderColor: PALETTE.blue,
              borderWidth: 1
            }, {
              label: 'Projected (2030)',
              data: [25.1, 9.8, 29.1, -22.0, 5.2, 4.8],
              backgroundColor: 'rgba(230,159,0,0.65)', // orange
              borderColor: PALETTE.orange,
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'bottom' } },
            scales: {
              y: { beginAtZero: true }
            }
          }
        });
      }
    }

    function initializeCountyCharts() {
      const ctx5 = document.getElementById('asalChart');
      if (ctx5) {
        new Chart(ctx5.getContext('2d'), {
          type: 'bar',
          data: {
            labels: ['Turkana', 'Marsabit', 'Garissa', 'Mandera', 'Wajir', 'Kajiado'],
            datasets: [{
              label: 'Mt CO₂eq',
              data: [4.2, 3.1, 2.8, 2.1, 1.9, 3.4],
              backgroundColor: PALETTE.orange,
              borderColor: PALETTE.orange,
              borderWidth: 1,
              borderRadius: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } }
          }
        });
      }

      const ctx6 = document.getElementById('perCapitaChart');
      if (ctx6) {
        new Chart(ctx6.getContext('2d'), {
          type: 'scatter',
          data: {
            datasets: [{
              label: 'ASAL Counties',
              data: [{x: 950000, y: 4.4}, {x: 460000, y: 6.7}, {x: 840000, y: 3.3}, {x: 870000, y: 2.4}],
              backgroundColor: PALETTE.purple,
              pointRadius: 4,
              pointStyle: 'triangle'
            }, {
              label: 'Other Counties',
              data: [{x: 4400000, y: 2.1}, {x: 2400000, y: 1.8}, {x: 2100000, y: 1.5}],
              backgroundColor: PALETTE.green,
              pointRadius: 4,
              pointStyle: 'circle'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'bottom' } },
            scales: {
              x: { title: { display: true, text: 'Population' } },
              y: { title: { display: true, text: 't CO₂eq per capita' } }
            }
          }
        });
      }
    }

    function initializeRegionalChart() {
      const ctx = document.getElementById('regionalChart');
      if (ctx) {
        new Chart(ctx.getContext('2d'), {
          type: 'bar',
          data: {
            labels: ['Kenya', 'Vietnam', 'Ethiopia', 'Tanzania', 'Uganda', 'Rwanda'],
            datasets: [{
              label: 'Total Emissions (Mt CO₂eq)',
              data: [87.6, 316.0, 180.2, 98.4, 89.1, 12.3],
              backgroundColor: [PALETTE.blue, PALETTE.orange, PALETTE.green, PALETTE.purple, PALETTE.yellow, PALETTE.sky],
              borderColor: '#ffffff',
              borderWidth: 1,
              borderRadius: 6
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: {
                  afterLabel: function(context) {
                    const country = context.label.toLowerCase();
                    const data = regionalData[country];
                    if (data) {
                      return `Per capita: ${data.perCapita} t CO₂eq\nMain source: ${data.mainSource}\nCarbon projects: ${data.carbonProjects}`;
                    }
                    return '';
                  }
                }
              }
            }
          }
        });
      }
    }

    function initializeCarbonCharts() {
      const ctx7 = document.getElementById('carbonProjectsChart');
      if (ctx7) {
        new Chart(ctx7.getContext('2d'), {
          type: 'doughnut',
          data: {
            labels: ['Forestry & Land Use', 'Clean Cookstoves', 'Agriculture', 'Clean Energy', 'Blue Carbon', 'Transport & Tech'],
            datasets: [{
              data: [35, 25, 20, 10, 5, 5],
              backgroundColor: [PALETTE.green, PALETTE.orange, PALETTE.blue, PALETTE.sky, PALETTE.purple, PALETTE.yellow],
              borderColor: '#ffffff',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: { padding: 20, usePointStyle: true }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.parsed || 0;
                    const projects = Math.round((value / 100) * 200);
                    return `${label}: ${value}% (≈${projects} projects)`;
                  }
                }
              }
            }
          }
        });
      }
    }

    // ---------- Init ----------
    document.addEventListener('DOMContentLoaded', () => {
      enableTabs();
      initializeOverviewCharts();
    });
  </script>
</body>
</html>
